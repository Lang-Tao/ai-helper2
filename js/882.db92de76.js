"use strict";(self["webpackChunkmy_app"]=self["webpackChunkmy_app"]||[]).push([[882],{43882:function(e,t,s){s.r(t),s.d(t,{default:function(){return g}});var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"login-container"},[s("div",{staticClass:"login-form"},[s("div",{staticClass:"form-content"},[s("el-form",{ref:"loginRef",staticStyle:{width:"80%"},attrs:{model:e.user,rules:e.rules}},[s("div",{staticClass:"form-title"},[e._v("欢迎登录智能工程助手")]),s("el-form-item",{attrs:{prop:"username"}},[s("el-input",{attrs:{"prefix-icon":"el-icon-user",size:"medium",placeholder:"请输入账号"},model:{value:e.user.username,callback:function(t){e.$set(e.user,"username",t)},expression:"user.username"}})],1),s("el-form-item",{attrs:{prop:"password"}},[s("el-input",{attrs:{"prefix-icon":"el-icon-lock",size:"medium","show-password":"",placeholder:"请输入密码"},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}})],1),s("el-form-item",{attrs:{prop:"code"}},[s("div",{staticClass:"code-input"},[s("el-input",{staticStyle:{flex:"1"},attrs:{placeholder:"请输入验证码","prefix-icon":"el-icon-circle-check",size:"medium"},model:{value:e.user.code,callback:function(t){e.$set(e.user,"code",t)},expression:"user.code"}}),s("div",{staticClass:"valid-code"},[s("valid-code",{on:{"update:value":e.getCode}})],1)],1)]),s("el-form-item",[s("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.login}},[e._v("登 录")])],1),s("div",{staticClass:"register-link"},[s("div",[e._v("还没有账号？请 "),s("span",{staticClass:"register",on:{click:function(t){return e.$router.push("/register")}}},[e._v("注册")])])])],1)],1),e._m(0)])])},o=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"form-image"},[r("img",{staticStyle:{width:"100%"},attrs:{src:s(65005),alt:""}})])}],a=(s(44114),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ValidCode disabled-select",staticStyle:{width:"100%",height:"100%"},on:{click:e.refreshCode}},e._l(e.codeList,(function(t,r){return s("span",{key:r,style:e.getStyle(t)},[e._v(e._s(t.code))])})),0)}),i=[],n={name:"validCode",data(){return{length:4,codeList:[]}},mounted(){this.createdCode()},methods:{refreshCode(){this.createdCode()},createdCode(){let e=this.length,t=[],s="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz0123456789",r=s.length;for(let o=0;o<e;o++){let e=[Math.round(220*Math.random()),Math.round(240*Math.random()),Math.round(200*Math.random())];t.push({code:s.charAt(Math.floor(Math.random()*r)),color:`rgb(${e})`,padding:`${[Math.floor(10*Math.random())]}px`,transform:`rotate(${Math.floor(90*Math.random())-Math.floor(90*Math.random())}deg)`})}this.codeList=t,this.$emit("update:value",t.map((e=>e.code)).join(""))},getStyle(e){return`color: ${e.color}; font-size: ${e.fontSize}; padding: ${e.padding}; transform: ${e.transform}`}}},l=n,c=s(81656),d=(0,c.A)(l,a,i,!1,null,null,null),u=d.exports,m=s(17585),h={name:"login",components:{ValidCode:u},data(){const e=(e,t,s)=>{""===t?s(new Error("请输入验证码")):t.toLowerCase()!==this.code?s(new Error("验证码错误")):s()};return{code:"",user:{code:"",username:"",password:""},rules:{username:[{required:!0,message:"请输入账号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],code:[{validator:e,trigger:"blur"}]}}},created(){},methods:{getCode(e){this.code=e.toLowerCase()},async login(){this.$refs["loginRef"].validate((async e=>{if(e)try{const e=await(0,m.iD)({username:this.user.username,password:this.user.password});0===e.code?(console.log(e),this.$store.commit("setToken",e.data.jwt),this.$store.commit("setUser",e.data.user),this.$router.push("/"),this.$message.success("登录成功")):this.$message.error(e.message||"登录失败")}catch(t){this.$message.error("登录请求失败，请稍后再试"),console.error(t)}}))}}},p=h,f=(0,c.A)(p,r,o,!1,null,"7bd707b9",null),g=f.exports},65005:function(e,t,s){e.exports=s.p+"img/login.7c1868b3.png"}}]);
//# sourceMappingURL=882.db92de76.js.map