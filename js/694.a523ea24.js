"use strict";(self["webpackChunkmy_app"]=self["webpackChunkmy_app"]||[]).push([[694],{2694:function(e,t,i){i.r(t),i.d(t,{default:function(){return y}});var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-container",[i("el-aside",{attrs:{width:"200px"}},[i("el-input",{attrs:{"suffix-icon":"el-icon-search",placeholder:"搜索笔记"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),i("div",[i("span",{staticStyle:{margin:"0 40px 0 23px"}},[e._v("页面目录")]),i("el-button",{staticClass:"add-btn",attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:e.addNote}}),i("el-button",{staticClass:"add-btn",attrs:{type:"primary",icon:"el-icon-folder-add",size:"mini"},on:{click:e.addFolder}})],1),i("el-divider"),i("el-tree",{attrs:{"highlight-current":"",data:e.filteredNotes,"node-key":"id","default-expand-all":"",props:{children:"children",label:function(e){return e.title.length>8?e.title.substring(0,8)+"...":e.title}},"render-content":e.renderContent,draggable:"","allow-drop":e.allowDrop},on:{"node-drop":e.handleDrop,"node-click":e.handleNodeClick}})],1),e.selectedNote?i("el-main",[i("WangEditor",{key:e.selectedNote.id,attrs:{Note:e.selectedNote},on:{saveNote:e.saveNote}})],1):i("el-main",{staticClass:"intro-main"},[i("span",[e._v("欢迎使用知识管理")]),i("span",{staticClass:"intro-text"},[e._v("知识库可以用来记录整个项目的来龙去脉，展示项目的当前状态，同时保存项目的相关资料，"),i("br"),e._v("能够让项目成员更好的进行文档书写和协作。")])])],1)},r=[],o=(i(4114),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{},[i("Toolbar",{staticStyle:{"border-bottom":"1px solid #ccc",padding:"0 5px"},attrs:{editor:e.editor,defaultConfig:e.toolbarConfig,mode:e.mode}}),i("div",{staticStyle:{margin:"20px"}},[i("div",{staticClass:"header",staticStyle:{display:"flex"}},[i("el-input",{staticClass:"title-input",staticStyle:{border:"none"},attrs:{placeholder:"请输入笔记标题"},model:{value:e.Note.title,callback:function(t){e.$set(e.Note,"title",t)},expression:"Note.title"}}),i("el-button",{attrs:{type:"text",size:"mini"},on:{click:e.onBlur}},[e._v("保存笔记")])],1),i("el-divider"),i("Editor",{staticStyle:{height:"585px",margin:"0 10px"},attrs:{defaultConfig:e.editorConfig,mode:e.mode},on:{onCreated:e.onCreated}})],1)],1)}),s=[],l=i(5471),d=i(1648),a=l["default"].extend({components:{Editor:d.K,Toolbar:d.M},props:{Note:{type:Object,default(){return{title:"",content:""}}}},data(){return{editor:null,toolbarConfig:{},editorConfig:{placeholder:"请输入内容..."},mode:"default"}},watch:{Note:{handler(e){this.editor&&e.content!==this.editor.getHtml()&&this.$nextTick((()=>{this.editor.setHtml(e.content)}))},deep:!0,immediate:!0}},methods:{onCreated(e){this.editor=Object.seal(e),this.Note.content&&this.editor.setHtml(this.Note.content)},onBlur(){console.log("Editor lost focus via global click detection"),this.$nextTick((()=>{this.saveNote()}))},saveNote(){if(this.editor){const e=this.editor.getHtml();console.log("Saving note with content:",e),this.Note.content=e}this.$emit("saveNote",this.Note)}},beforeDestroy(){const e=this.editor;null!=e&&e.destroy()}}),c=a,h=i(1656),u=(0,h.A)(c,o,s,!1,null,"5e87242f",null),f=u.exports,p={components:{WangEditor:f},data(){return{currentName:"",search:"",selectedNote:null,noteList:[{title:"笔记1",id:1,folder:null,content:"这是笔记1的内容"},{title:"笔记笔记笔记记记记",id:2,folder:null,content:"这是笔记2的内容"},{title:"文件夹1",id:3,isFolder:!0,children:[{title:"子笔记1",id:4,folder:3,content:"这是子笔记1的内容"}]}],editorOptions:{theme:"snow",modules:{toolbar:[[{header:[1,2,!1]}],["bold","italic","underline"],["image","code-block"]]}}}},computed:{filteredNotes(){return this.search?this.filterNotes(this.noteList,this.search.toLowerCase()):this.noteList}},methods:{filterNotes(e,t){return e.map((e=>{if(e.children){const i=this.filterNotes(e.children,t);if(i.length)return{...e,children:i}}return e.title.toLowerCase().includes(t)?{...e}:null})).filter((e=>null!==e))},handleNodeClick(e){e.isFolder||(this.selectedNote={...e})},saveNote(e){if(!e)return;const t=this.findNoteById(this.noteList,e.id);t&&(t.content=e.content,t.title=e.title),this.$message({message:"笔记保存成功",type:"success"})},findNoteById(e,t){for(const i of e){if(i.id===t)return i;if(i.children){const e=this.findNoteById(i.children,t);if(e)return e}}return null},addNote(){this.noteList.push({title:"未命名页面",id:Date.now()}),this.$message({message:"添加成功",type:"success"})},addFolder(){this.noteList.push({title:"未命名文件夹",isFolder:!0,id:Date.now(),children:[]}),this.$message({message:"添加成功",type:"success"})},deleteNode(e){const t=(e,i)=>{for(let n=0;n<e.length;n++){if(e[n].id===i)return void e.splice(n,1);e[n].children&&t(e[n].children,i)}};this.$confirm("此操作将永久删除该笔记, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{t(this.noteList,e.id),this.$message({type:"success",message:"删除成功!"})})).catch((()=>{}))},renderContent(e,{node:t,data:i}){return e("span",[e("span",{class:"custom-tree-node"},[e("span",{domProps:{innerHTML:i.isEdit?"":t.label},on:{dblclick:()=>this.headerDbClick(i)}}),e("input",{directives:[{name:"show",value:i.isEdit}],ref:i.id,attrs:{placeholder:"请输入内容"},domProps:{value:this.currentName},on:{blur:e=>this.handleInputBlur(e,i)}})]),e("el-button",{attrs:{icon:"el-icon-delete",type:"text"},on:{click:()=>this.deleteNode(i)}})])},headerDbClick(e){this.currentName=e.title,this.$set(e,"isEdit",!0),this.$nextTick((()=>{this.$refs[e.id]&&this.$refs[e.id].focus()}))},handleInputBlur(e,t){const i=e.target.value.trim();""===i?(this.$message({type:"warning",message:"分类名称不能为空,请重新输入"}),this.$set(t,"isEdit",!1)):i===t.title?this.$set(t,"isEdit",!1):(this.$set(t,"isEdit",!1),t.title=i),this.currentName=""},allowDrop(e,t,i){return"inner"!==i||t.data.isFolder},handleDrop(e,t,i){const n=e.data,r=t.data;if("inner"===i&&r.isFolder)r.children.push(n),this.removeNode(this.noteList,n.id);else if("before"===i||"after"===i){this.removeNode(this.noteList,n.id);const e=this.findParentArray(this.noteList,r.id),t=e.findIndex((e=>e.id===r.id));"before"===i?e.splice(t,0,n):e.splice(t+1,0,n)}},removeNode(e,t){for(let i=0;i<e.length;i++){if(e[i].id===t)return void e.splice(i,1);e[i].children&&this.removeNode(e[i].children,t)}},findParentArray(e,t){for(let i=0;i<e.length;i++){if(e[i].id===t)return e;if(e[i].children){const n=this.findParentArray(e[i].children,t);if(n)return n}}return null}}},m=p,g=(0,h.A)(m,n,r,!1,null,"460e9f2e",null),y=g.exports},4527:function(e,t,i){var n=i(3724),r=i(4376),o=TypeError,s=Object.getOwnPropertyDescriptor,l=n&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=l?function(e,t){if(r(e)&&!s(e,"length").writable)throw new o("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},6837:function(e){var t=TypeError,i=9007199254740991;e.exports=function(e){if(e>i)throw t("Maximum allowed index exceeded");return e}},4376:function(e,t,i){var n=i(4576);e.exports=Array.isArray||function(e){return"Array"===n(e)}},4114:function(e,t,i){var n=i(6518),r=i(8981),o=i(6198),s=i(4527),l=i(6837),d=i(9039),a=d((function(){return 4294967297!==[].push.call({length:4294967296},1)})),c=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}},h=a||!c();n({target:"Array",proto:!0,arity:1,forced:h},{push:function(e){var t=r(this),i=o(t),n=arguments.length;l(i+n);for(var d=0;d<n;d++)t[i]=arguments[d],i++;return s(t,i),i}})}}]);
//# sourceMappingURL=694.a523ea24.js.map