{"version":3,"file":"js/968.5f757eda.js","mappings":"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","sources":["webpack://my-app/./src/views/Manager/Check/PersonCheck.vue?3ff7","webpack://my-app/src/views/Manager/Check/PersonCheck.vue","webpack://my-app/./src/views/Manager/Check/PersonCheck.vue?5346","webpack://my-app/./src/views/Manager/Check/PersonCheck.vue","webpack://my-app/./src/api/project.js"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"intelligence-check\"},[_c('div',{staticClass:\"select-box\"},[_c('div',[_c('el-select',{attrs:{\"placeholder\":\"请选择项目\"},model:{value:(_vm.selectedProjectName),callback:function ($$v) {_vm.selectedProjectName=$$v},expression:\"selectedProjectName\"}},_vm._l((_vm.projectList),function(project){return _c('el-option',{key:project.address,attrs:{\"value\":project.name}})}),1),_c('el-cascader',{staticStyle:{\"margin-left\":\"20px\",\"width\":\"500px\"},attrs:{\"options\":_vm.fileList,\"props\":_vm.cascaderProps},model:{value:(_vm.selectedFile),callback:function ($$v) {_vm.selectedFile=$$v},expression:\"selectedFile\"}})],1),_c('div',[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.review}},[_vm._v(\"审查\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.submit}},[_vm._v(\"提交\")])],1)]),_c('div',{staticClass:\"overview\"},[_c('div',{staticClass:\"code-view\"},[(_vm.fileContent.length === 0)?_c('div',{staticClass:\"empty-box\"},[_c('span',{staticClass:\"empty-text\"},[_vm._v(\"请在上方选择审查文件\")])]):_c('div',{staticClass:\"code-box\"},[_c('pre',[_vm._v(_vm._s(_vm.fileContent))])])]),_c('div',{staticClass:\"comment\"},[_c('el-input',{attrs:{\"type\":\"textarea\",\"autosize\":{ minRows: 8, maxRows: 20},\"placeholder\":\"请输入审查意见\"},model:{value:(_vm.comment),callback:function ($$v) {_vm.comment=$$v},expression:\"comment\"}})],1)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"intelligence-check\">\r\n\r\n    <div class=\"select-box\">\r\n\r\n      <div>\r\n        <el-select v-model=\"selectedProjectName\" placeholder=\"请选择项目\">\r\n        <el-option v-for=\"project in projectList\"\r\n        :key=\"project.address\"\r\n        :value=\"project.name\">\r\n        </el-option>\r\n        </el-select>\r\n\r\n        <el-cascader style=\"margin-left: 20px; width:500px\"\r\n        v-model=\"selectedFile\"\r\n        :options=\"fileList\"\r\n        :props=\"cascaderProps\"></el-cascader>\r\n      </div>\r\n\r\n      <div>\r\n        <el-button type=\"primary\" @click=\"review\">审查</el-button>\r\n        <el-button type=\"primary\" @click=\"submit\">提交</el-button>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"overview\">\r\n      <div class=\"code-view\">\r\n        <div v-if=\"fileContent.length === 0\" class=\"empty-box\">\r\n            <span class=\"empty-text\">请在上方选择审查文件</span>\r\n        </div>\r\n        <div v-else class=\"code-box\">\r\n          <pre>{{ fileContent }}</pre>\r\n\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"comment\">\r\n        <el-input\r\n        type=\"textarea\"\r\n        :autosize=\"{ minRows: 8, maxRows: 20}\"\r\n        placeholder=\"请输入审查意见\"\r\n        v-model=\"comment\"></el-input>\r\n      </div>\r\n    </div>\r\n      \r\n   \r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getProjectList } from \"@/api/project\";\r\nimport { getProjectFileList } from \"@/api/project\";\r\nimport { getProjectFileContent } from \"@/api/project\";\r\n\r\nexport default {\r\n  name: \"personCheck\",\r\n  components: {},\r\n  data() {\r\n    return {\r\n      comment: \"\",\r\n      projectList: [],\r\n      fileList: [],\r\n      cascaderProps: {\r\n        value: \"name\",\r\n        label: \"name\",\r\n        children: \"children\",\r\n      },\r\n      selectedFile: \"\",\r\n      selectedProjectName: \"\",\r\n      repository: {},\r\n      fileContent: \"\",\r\n    };\r\n  },\r\n  computed: {},\r\n  methods: {\r\n    // 获取文件列表\r\n    getFileList() {\r\n      getProjectFileList(this.selectedProjectRepo)\r\n        .then((res) => {\r\n          console.log(this.selectedProjectName + \"文件列表：\");\r\n          console.log(res);\r\n          if (res.code === 0) {\r\n            this.fileList = this.removeEmptyChildren(res.data.fileList);\r\n            console.log(\"修改后的数据\");\r\n            console.log(this.fileList);\r\n          } else {\r\n            console.error(res.message || \"获取列表失败\");\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          console.error(\"Error:\", err);\r\n        });\r\n    },\r\n\r\n    // 处理返回数据格式\r\n    removeEmptyChildren(data) {\r\n      // 遍历每个对象\r\n      return data.map((item) => {\r\n        // 如果该对象有children，并且children不为空\r\n        if (item.children && item.children.length > 0) {\r\n          // 递归处理其子节点\r\n          item.children = this.removeEmptyChildren(item.children);\r\n        }\r\n        // 如果children是空的，删除children属性\r\n        if (item.children && item.children.length === 0) {\r\n          delete item.children;\r\n        }\r\n        return item;\r\n      });\r\n    },\r\n\r\n    // 获取项目列表\r\n    getProjectList() {\r\n      getProjectList()\r\n        .then((res) => {\r\n          console.log(\"项目列表：\");\r\n          console.log(res);\r\n\r\n          if (res.code === 0) {\r\n            this.projectList = res.data;\r\n            this.selectedProjectName =\r\n              this.projectList.length > 0 ? this.projectList[0].name : \"\";\r\n          } else {\r\n            console.error(res.message || \"获取列表失败\");\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          console.error(\"Error:\", err);\r\n        });\r\n    },\r\n\r\n    // 审查代码\r\n    review() {\r\n      if (this.selectedFile.length !== 0) {\r\n        console.log(\r\n          \"path:\" +\r\n            this.selectedFile.join(\"/\") +\r\n            \"   address:\" +\r\n            this.selectedProjectAddress\r\n        );\r\n\r\n        // 调用获取文件内容接口\r\n        getProjectFileContent(\r\n          this.selectedFile.join(\"/\"),\r\n          this.selectedProjectAddress\r\n        ).then((res) => {\r\n          console.log(\"文件内容：\");\r\n          console.log(res);\r\n          if (res.code === 0) {\r\n            this.fileContent = res.data;\r\n          } else {\r\n            console.error(res.message || \"获取文件内容失败\");\r\n          }\r\n        });\r\n      } else {\r\n        this.$message.warning(\"请选择文件\");\r\n      }\r\n    },\r\n\r\n    // 提交代码审查意见\r\n    submit() {\r\n      // todo 调用提交评论接口\r\n      // 此处为模拟数据\r\n      this.comment = \"\";\r\n      this.fileContent = \"\";\r\n      this.$message.success(\"提交成功\");\r\n    },\r\n  },\r\n  mounted() {\r\n    this.getProjectList();\r\n    this.getFileList();\r\n  },\r\n  watch: {\r\n    selectedProjectName(newVal) {\r\n      // 根据项目名获取文件列表\r\n      this.getFileList();\r\n    },\r\n  },\r\n  computed: {\r\n    selectedProjectRepo() {\r\n      return this.projectList.find(\r\n        (item) => item.name === this.selectedProjectName\r\n      )?.repositoryId;\r\n    },\r\n    selectedProjectAddress() {\r\n      return this.projectList.find(\r\n        (item) => item.name === this.selectedProjectName\r\n      )?.address;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n\r\n<style scoped lang=\"scss\">\r\n.intelligence-check {\r\n  padding: 24px;\r\n  background-color: #f0f0f07b;\r\n}\r\n.select-box {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n.overview {\r\n  margin-top: 20px;\r\n  height: 92%;\r\n  background-color: #f0f0f07b;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n.code-view {\r\n  min-height: 500px;\r\n  display: flex;\r\n  flex: 3;\r\n  background-color: #fff;\r\n  margin-bottom: 10px;\r\n  border-bottom: 1px solid #cccccc64;\r\n  border: 1px solid #cccccc64;\r\n  border-radius: 5px;\r\n}\r\n.comment {\r\n  display: flex;\r\n  flex: 1;\r\n  background-color: #fff;\r\n  border: 1px solid #cccccc64;\r\n  border-radius: 5px;\r\n  padding: 10px;\r\n}\r\n.empty-box {\r\n  padding: 250px 520px;\r\n  height: 500px;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  flex-direction: column;\r\n}\r\n.empty-text {\r\n  font-size: 30px;\r\n  text-align: center;\r\n  color: #37373774;\r\n}\r\n\r\n.el-icon-folder {\r\n  color: #83cdff;\r\n  margin-left: 10px;\r\n  margin-right: 8px;\r\n}\r\n.el-icon-document {\r\n  color: #1f1f1f;\r\n  margin-left: 10px;\r\n  margin-right: 8px;\r\n}\r\n.repository {\r\n  width: 97%;\r\n\r\n  background-color: #ffffff;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  overflow: hidden;\r\n}\r\n.file-name:hover {\r\n  color: #409eff;\r\n  cursor: pointer;\r\n}\r\n\r\n.code-box {\r\n  padding: 10px;\r\n}\r\n</style>\r\n\r\n<style>\r\n.el-textarea__inner {\r\n  border: none;\r\n  font-size: 16px;\r\n  line-height: 18px;\r\n}\r\n</style>\r\n\r\n\r\n\r\n\r\n","import mod from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PersonCheck.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PersonCheck.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./PersonCheck.vue?vue&type=template&id=529d1388&scoped=true\"\nimport script from \"./PersonCheck.vue?vue&type=script&lang=js\"\nexport * from \"./PersonCheck.vue?vue&type=script&lang=js\"\nimport style0 from \"./PersonCheck.vue?vue&type=style&index=0&id=529d1388&prod&scoped=true&lang=scss\"\nimport style1 from \"./PersonCheck.vue?vue&type=style&index=1&id=529d1388&prod&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"529d1388\",\n  null\n  \n)\n\nexport default component.exports","import request from \"@/utils/request\";\r\n\r\n// 获取项目列表\r\nexport function getProjectList() {\r\n  return request({\r\n    url: \"/project\",\r\n    method: \"GET\",\r\n    headers: {\r\n      Authorization: localStorage.getItem(\"token\")\r\n    }\r\n  });\r\n}\r\n\r\n// 创建项目\r\nexport function createProject(data) {\r\n  return request({\r\n    url: \"/project\",\r\n    method: \"POST\",\r\n    data:data,\r\n    headers: {\r\n      Authorization: localStorage.getItem(\"token\")\r\n    }\r\n  });\r\n}\r\n\r\n// 根据项目地址获取项目信息\r\nexport function getProjectInfo(address) {\r\n  return request({\r\n    url: `/project/address?address=${address}`,\r\n    method: \"GET\",\r\n    headers: {\r\n      Authorization: localStorage.getItem(\"token\")\r\n    }\r\n  });\r\n}\r\n\r\n// 更新项目信息\r\nexport function updateProject(data) {\r\n  return request({\r\n    url: \"/project\",\r\n    method: \"PUT\",\r\n    data:data,\r\n    headers: {\r\n      Authorization: localStorage.getItem(\"token\")\r\n    }\r\n  });\r\n}\r\n\r\n// 获取项目文件名\r\nexport function getProjectFileList(repo) {\r\n  return request({\r\n    url: `/gitea/listpath?repo=${repo}`,\r\n    method: \"GET\",\r\n    headers: {\r\n      Authorization: localStorage.getItem(\"token\")\r\n    }\r\n  });\r\n}\r\n\r\n// 根据 文件路径 和 仓库地址 获取文件\r\nexport function getProjectFileContent(path, address) {\r\n  return request({\r\n    url: `/gitea/getfile?path=${path}&address=${address}`,\r\n    method: \"GET\",\r\n    headers: {\r\n      Authorization: localStorage.getItem(\"token\")\r\n    }\r\n  })\r\n}\r\n\r\n//删除项目\r\nexport function deleteProject(address) {\r\n  return request({\r\n    url: `/project?address=${address}`,\r\n    method: \"DELETE\",\r\n    headers: {\r\n      Authorization: localStorage.getItem(\"token\")\r\n    }\r\n  })\r\n}"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","model","value","callback","$$v","selectedProjectName","expression","_l","project","key","address","name","staticStyle","fileList","cascaderProps","selectedFile","on","review","_v","submit","fileContent","length","_s","minRows","maxRows","comment","staticRenderFns","components","data","projectList","label","children","repository","computed","methods","getFileList","getProjectFileList","selectedProjectRepo","then","res","console","log","code","removeEmptyChildren","error","message","catch","err","map","item","getProjectList","join","selectedProjectAddress","getProjectFileContent","$message","warning","success","mounted","watch","newVal","find","repositoryId","component","request","url","method","headers","Authorization","localStorage","getItem","createProject","getProjectInfo","updateProject","repo","path","deleteProject"],"sourceRoot":""}