"use strict";(self["webpackChunkmy_app"]=self["webpackChunkmy_app"]||[]).push([[642],{79642:function(e,t,r){r.r(t),r.d(t,{default:function(){return h}});var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"team-member"},[r("div",{staticClass:"header-box"},[r("el-select",{attrs:{placeholder:"请选择项目"},model:{value:e.selectedProjectName,callback:function(t){e.selectedProjectName=t},expression:"selectedProjectName"}},e._l(e.projectList,(function(t){return r("el-option",{key:t.address,attrs:{value:t.name}},[e._v(" "+e._s(t.name)+" ")])})),1),r("div",{staticClass:"btn-box"},[r("el-input",{staticStyle:{"margin-right":"10px"},attrs:{placeholder:"请输入成员名称",size:"mini"},model:{value:e.newMemberName,callback:function(t){e.newMemberName=t},expression:"newMemberName"}}),r("el-button",{attrs:{type:"text"},on:{click:e.addMember}},[e._v("添加成员")]),r("el-button",{attrs:{type:"text"},on:{click:e.saveTeam}},[e._v("保存更改")])],1)],1),r("div",{staticClass:"member-list-container"},[r("el-table",{staticClass:"member-list",staticStyle:{width:"100%"},attrs:{data:e.currentTeam.members,"row-style":{height:"20px"},"cell-style":{padding:"7px"}}},[r("el-table-column",{attrs:{label:"成员名称",align:"center",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{staticClass:"username"},[r("el-avatar",{attrs:{src:t.row.user.avatar,size:"small"}}),r("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.user.username))]),r("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(r){return e.deleteMember(t.row)}}})],1)]}}])}),r("el-table-column",{attrs:{label:"邮箱",align:"center",width:"590"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.user.email))])]}}])}),r("el-table-column",{attrs:{label:"角色",align:"center",width:"500"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-select",{staticClass:"role-select",attrs:{placeholder:"选择角色",size:"small"},model:{value:t.row.role,callback:function(r){e.$set(t.row,"role",r)},expression:"scope.row.role"}},[r("el-option",{attrs:{label:"项目经理",value:"项目经理"}}),r("el-option",{attrs:{label:"前端",value:"前端"}}),r("el-option",{attrs:{label:"后端",value:"后端"}})],1)]}}])})],1)],1)])},o=[],n=r(27673),s=r(35720);function l(e){return(0,s.A)({url:"/member",method:"get",params:{projectId:e},headers:{Authorization:localStorage.getItem("token")}})}function c(e){return(0,s.A)({url:"/member/"+e,method:"delete",headers:{Authorization:localStorage.getItem("token")}})}var i={name:"TeamMember",data(){return{isAdmin:!0,projectList:[],selectedProjectName:"",currentTeam:{},newMemberName:""}},methods:{getProjectList(){(0,n.wD)().then((e=>{0===e.code?(this.projectList=e.data,this.selectedProjectName=this.projectList.length>0?this.projectList[0].name:"",this.currentTeam=this.getTeamById(this.selectedProject.id)):console.error(e.message||"获取列表失败")})).catch((e=>{console.error("Error:",e)}))},getTeamById(e){l(e).then((e=>{0===e.code?(console.log("获取团队信息接口返回数据："+e),console.log(e),this.currentTeam=e.data):console.error(e.message||"获取团队信息失败")})).catch((e=>{console.error("Error:",e)}))},saveTeam(){},addMember(e){},deleteMember(e){const t=this.selectedProject.id;c(t,e.id).then((t=>{0===t.code?(this.$message.success("删除成功"),this.currentTeam.members=this.currentTeam.members.filter((t=>t.id!==e.id))):this.$message.error("删除失败")})).catch((e=>{console.error("Error:",e)}))}},watch:{selectedProjectName(e){this.selectedProject=this.projectList.find((t=>t.name===e)),this.getTeamById(this.selectedProject.id)}},created(){this.getProjectList()}},u=i,d=r(81656),m=(0,d.A)(u,a,o,!1,null,"1eb654df",null),h=m.exports},27673:function(e,t,r){r.d(t,{An:function(){return s},RX:function(){return i},WV:function(){return c},gA:function(){return n},vr:function(){return l},wD:function(){return o},xx:function(){return u}});var a=r(35720);function o(){return(0,a.A)({url:"/project",method:"GET",headers:{Authorization:localStorage.getItem("token")}})}function n(e){return(0,a.A)({url:"/project",method:"POST",data:e,headers:{Authorization:localStorage.getItem("token")}})}function s(e){return(0,a.A)({url:`/project/address?address=${e}`,method:"GET",headers:{Authorization:localStorage.getItem("token")}})}function l(e){return(0,a.A)({url:"/project",method:"PUT",data:e,headers:{Authorization:localStorage.getItem("token")}})}function c(e){return(0,a.A)({url:`/gitea/listpath?repo=${e}`,method:"GET",headers:{Authorization:localStorage.getItem("token")}})}function i(e,t){return(0,a.A)({url:`/gitea/getfile?path=${e}&address=${t}`,method:"GET",headers:{Authorization:localStorage.getItem("token")}})}function u(e){return(0,a.A)({url:`/project?address=${e}`,method:"DELETE",headers:{Authorization:localStorage.getItem("token")}})}}}]);
//# sourceMappingURL=642.f012db6d.js.map